---
# Enable Debug Logging

- name: Enable debug logging in SonarQube
  ansible.builtin.lineinfile:
    path: "{{ sonarqube.config_path }}"
    regexp: "^#?sonar.log.level="
    line: "sonar.log.level=DEBUG"
    backup: true
  become: true
  notify: restart_sonarqube

- name: Debug - Display configuration variables
  ansible.builtin.debug:
    msg:
      - "SonarQube Base URL: {{ sonarqube.base_url }}"
      - "Keycloak Base URL: {{ sonarqube_keycloak_saml_keycloak.base_url }}"
      - "Keycloak Realm: {{ sonarqube_keycloak_saml_keycloak.realm }}"
      - "SAML Client ID: {{ sonarqube_keycloak_saml_keycloak.saml_client.client_id }}"
      - "Protocol Mappers: {{ sonarqube_keycloak_saml_keycloak.saml_client.protocol_mappers | length }} configured"
