---
# Playbook: Configure Jenkins SAML Integration with Keycloak
# This playbook sets up SAML SSO between Jenkins and Keycloak
# using the generic keycloak_saml_integration role

- name: Configure Jenkins SAML Integration with Keycloak
  hosts: jenkins_servers
  become: yes

  vars:
    # Application Type Configuration
    keycloak_saml_integration_app_type: "jenkins"

  roles:
    - role: keycloak_saml_integration
      tags:
        - jenkins
        - saml
        - keycloak

  post_tasks:
    - name: Display SAML login instructions
      ansible.builtin.debug:
        msg:
          - "ğŸ‰ Jenkins SAML Integration Complete!"
          - ""
          - "ğŸ“‹ Test User Credentials:"
          - "   Username: jenkins-demo"
          - "   Password: JenkinsDemo123!"
          - "   Groups: jenkins-users, jenkins-admins"
          - ""
          - "ğŸ” SAML Login URL:"
          - "   {{ jenkins_base_url }}/securityRealm/commenceLogin"
          - ""
          - "ğŸ’¡ Note: Jenkins SAML plugin doesn't show a login button on the default login page."
          - "   Users must navigate directly to the SAML login URL above."
          - ""
          - "ğŸ”§ Alternative: Create a bookmark or redirect users to the SAML login URL."
