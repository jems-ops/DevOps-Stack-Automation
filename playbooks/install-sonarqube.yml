---
- name: Install SonarQube on SonarQube Server
  hosts: sonarqube_servers
  gather_facts: yes
  become: yes

  pre_tasks:
    - name: Display installation information
      debug:
        msg: |
          ğŸ” SonarQube Installation Playbook
          ğŸ“… Execution time: {{ ansible_date_time.iso8601 }}
          ğŸ–¥ï¸  Target server: {{ inventory_hostname }}
          ğŸ‘¤ User: {{ ansible_user }}

  roles:
    - install-sonarqube

  post_tasks:
    - name: Display completion message
      debug:
        msg: |
          âœ… SonarQube Installation Playbook Complete!

          ğŸ“Š Summary:
          â€¢ SonarQube installed on: {{ inventory_hostname }}
          â€¢ Access URL: http://{{ inventory_hostname }}:9000
          â€¢ Default credentials: admin/admin
          â€¢ Database: PostgreSQL

          ğŸ”§ Next Steps:
          1. Access SonarQube web interface
          2. Change default admin password
          3. Configure quality gates and rules
          4. Set up project analysis
          5. Configure reverse proxy (run setup-nginx-reverse-proxy.yml)
